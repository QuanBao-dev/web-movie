{"version":3,"sources":["../../../../src/internal/operators/combineAll.ts","../../../../src/internal/operators/startWith.ts","epics/comment.js","store/comment.js","components/ReviewItem/ReviewItem.js"],"names":["combineAll","project","scheduler","array","length","isScheduler","chatStream","chatStore","validateInput$","inputElement","inputAuthorElement","buttonSubmitElement","disabled","inputAuthor$","fromEvent","pipe","pluck","startWith","currentState","currentName","input$","from","map","textAuthor","trim","fetchPageMessage$","malId","timer","switchMapTo","ajax","url","currentPage","res","response","message","catchError","of","timeSince","date","seconds","Math","floor","Date","interval","initialState","messages","numberCommentOfEachPage","indexInputDisplayBlock","shouldFetchComment","lastPageComment","triggerFetch","behaviorSubject","BehaviorSubject","state","subscribe","setState","v","init","next","updateData","object","ans","updateMessages","lastPage","updateCurrentPage","page","updateCurrentName","name","ReviewItem","review","type","className","src","user","images","webp","image_url","alt","username","votes","episodes_watched","chapters_read","getTime","Object","keys","scores","key","index","replace","split","slice","join","onClick","e","target","parentElement","innerHTML"],"mappings":"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","file":"static/js/40.ada07544.chunk.js","sourcesContent":[null,null,"import { fromEvent, timer, of, from } from \"rxjs\";\r\nimport { ajax } from \"rxjs/ajax\";\r\nimport {\r\n  map,\r\n  switchMapTo,\r\n  catchError,\r\n  combineAll,\r\n  pluck,\r\n  startWith,\r\n} from \"rxjs/operators\";\r\n\r\nimport chatStore from \"../store/comment\";\r\n\r\nexport const chatStream = chatStore;\r\n\r\nexport const validateInput$ = (\r\n  inputElement,\r\n  inputAuthorElement,\r\n  buttonSubmitElement\r\n) => {\r\n  buttonSubmitElement.disabled = true;\r\n  const inputAuthor$ = fromEvent(inputAuthorElement, \"input\").pipe(\r\n    pluck(\"target\", \"value\"),\r\n    startWith(chatStream.currentState().currentName)\r\n  );\r\n  const input$ = fromEvent(inputElement, \"input\").pipe(\r\n    pluck(\"target\", \"innerText\"),\r\n    startWith(\"\")\r\n  );\r\n  return from([inputAuthor$, input$]).pipe(\r\n    combineAll(),\r\n    map(([inputAuthor, input]) => {\r\n      const text = input;\r\n      const textAuthor = inputAuthor;\r\n      if (text.trim() === \"\" || textAuthor.trim() === \"\") {\r\n        buttonSubmitElement.disabled = true;\r\n      } else {\r\n        buttonSubmitElement.disabled = false;\r\n      }\r\n    })\r\n  );\r\n};\r\n\r\nexport const fetchPageMessage$ = (malId) => {\r\n  return timer(0).pipe( \r\n    switchMapTo(\r\n      ajax({\r\n        url: `/api/movies/${malId}?page=`+chatStream.currentState().currentPage,\r\n      }).pipe(\r\n        map((res) => res.response.message),\r\n        catchError(() => of([]))\r\n      )\r\n    )\r\n  );\r\n};\r\n\r\nexport const timeSince = (date) => {\r\n  var seconds = Math.floor((new Date() - date) / 1000);\r\n\r\n  var interval = seconds / 31536000;\r\n\r\n  if (interval > 1) {\r\n    return Math.floor(interval) + \" years\";\r\n  }\r\n  interval = seconds / 2592000;\r\n  if (interval > 1) {\r\n    return Math.floor(interval) + \" months\";\r\n  }\r\n  interval = seconds / 86400;\r\n  if (interval > 1) {\r\n    return Math.floor(interval) + \" days\";\r\n  }\r\n  interval = seconds / 3600;\r\n  if (interval > 1) {\r\n    return Math.floor(interval) + \" hours\";\r\n  }\r\n  interval = seconds / 60;\r\n  if (interval > 1) {\r\n    return Math.floor(interval) + \" minutes\";\r\n  }\r\n  if (Math.floor(seconds) === 1) {\r\n    return Math.floor(seconds) + \" second\";\r\n  }\r\n  if (Math.floor(seconds) === 0) {\r\n    return \"Recently\";\r\n  }\r\n  return Math.floor(seconds) + \" seconds\";\r\n};\r\n","import { BehaviorSubject } from \"rxjs\";\r\n\r\nconst initialState = {\r\n  messages: [],\r\n  currentPage: 1,\r\n  numberCommentOfEachPage: 5,\r\n  indexInputDisplayBlock: null,\r\n  malId: null,\r\n  shouldFetchComment: true,\r\n  currentName: \"\",\r\n  lastPageComment: 1,\r\n  triggerFetch: 0,\r\n};\r\n\r\nconst behaviorSubject = new BehaviorSubject();\r\nlet state = initialState;\r\nconst chatStore = {\r\n  initialState,\r\n  subscribe: (setState) => behaviorSubject.subscribe((v) => setState(v)),\r\n  init: () => {\r\n    behaviorSubject.next(state);\r\n  },\r\n  updateData: (object = initialState) => {\r\n    state = {\r\n      ...state,\r\n      ...object,\r\n    };\r\n    behaviorSubject.next(state);\r\n  },\r\n  currentState: () => {\r\n    let ans;\r\n    behaviorSubject.subscribe((v) => {\r\n      ans = v;\r\n    });\r\n    return ans || initialState;\r\n  },\r\n  updateMessages: (messages, lastPage) => {\r\n    state = {\r\n      ...state,\r\n      messages: messages,\r\n      lastPageComment: lastPage,\r\n    };\r\n    behaviorSubject.next(state);\r\n  },\r\n\r\n  updateCurrentPage: (page) => {\r\n    state = {\r\n      ...state,\r\n      currentPage: page,\r\n    };\r\n    behaviorSubject.next(state);\r\n  },\r\n};\r\n\r\nexport const updateCurrentName = (name) => {\r\n  state.currentName = name;\r\n};\r\nexport default chatStore;\r\n","import \"./ReviewItem.css\";\r\nimport React from \"react\";\r\nimport { timeSince } from \"../../epics/comment\";\r\n\r\nfunction ReviewItem({ review, type }) {\r\n  return (\r\n    <div className=\"review-item\">\r\n      <div className=\"user-info-review-container\">\r\n        <div className=\"user-info-review\">\r\n          <img src={review.user.images.webp.image_url} alt=\"Image_reviewer\" />\r\n          <div>\r\n            <div className=\"username\">{review.user.username}</div>\r\n            <div className=\"helpful-count\">\r\n              {review.votes} people found this review helpful\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div>\r\n          {type === \"anime\"\r\n            ? `${review.episodes_watched} episode${\r\n                review.episodes_watched > 1 ? \"s\" : \"\"\r\n              } watched`\r\n            : `${review.chapters_read} chapter${\r\n                review.chapters_read > 1 ? \"s\" : \"\"\r\n              } read`}\r\n        </div>\r\n      </div>\r\n      <div className=\"time-since-review\">\r\n        {timeSince(new Date(review.date).getTime()) === \"Recently\"\r\n          ? `Recently`\r\n          : `${timeSince(new Date(review.date).getTime())} ago`}\r\n      </div>\r\n      <div className=\"container-board-evaluate\">\r\n        <div>\r\n          {Object.keys(review.scores).map((key, index) => (\r\n            <div className=\"section-evaluate\" key={index}>\r\n              <span>{key}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n        <div>\r\n          {Object.keys(review.scores).map((key, index) => (\r\n            <div key={index}>\r\n              <span className=\"score-section\">{review.scores[key]}</span>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n      <pre>\r\n        {review.review.replace(/\\\\n/g, \"\").split(\" \").slice(0, 100).join(\" \")}\r\n        {review.review.replace(/\\\\n/g, \"\").split(\" \").length > 100 ? (\r\n          <span\r\n            className=\"show-more-text\"\r\n            onClick={(e) => {\r\n              e.target.parentElement.innerHTML = review.review.replace(\r\n                /\\\\n/g,\r\n                \"\"\r\n              );\r\n            }}\r\n          >\r\n            ...Show more\r\n          </span>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </pre>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ReviewItem;\r\n"],"sourceRoot":""}