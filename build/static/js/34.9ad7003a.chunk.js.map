{"version":3,"sources":["util/checkMobileDevice.js","store/lazyLoadAnimeList.js","epics/lazyLoadAnimeList.js","components/AnimeList/AnimeList.js","components/RelatedAnime/RelatedAnime.js"],"names":["mobileAndTabletCheck","a","check","navigator","userAgent","vendor","window","opera","test","substr","initialState","genreDetailData","pageOnDestroy","pageIsLoaded","isChangeView","isStopScrollingUpdated","currentPageOnDestroy","query","pageGenre","numberAnimeShowMore","parseInt","innerHeight","width","height","quantityItemPerRow","widthItem","heightItem","rowStart","rowEnd","widthContainerList","trigger","subject","BehaviorSubject","state","lazyLoadAnimeListStream","subscribe","setState","pipe","v","currentState","ans","init","next","updateData","data","updateDataQuick","keys","Object","forEach","key","fetchDataGenreAnimeList$","page","url","idCartoonUser","searchBy","obj","method","replace","includes","headers","authorization","iif","cachesStore","genres","timer","map","filter","tap","mergeMapTo","mergeMap","ajax","timeout","pluck","catchError","of","error","updatePageScrollingWindow$","fromEvent","document","body","scrollHeight","scrollY","debounceTime","calculateRowStartEnd","containerListRef","offsetTopContainerList","current","offsetTop","currentRow","Math","ceil","numberRowToFillTheScreen","responsiveObject","maxWidth","minWidth","AnimeItem","loadable","handleResponsiveWidth","animeListRef","lazyLoadState","i","length","innerWidth","AnimeList","isWrap","lazy","empty","virtual","isAllowDelete","type","useRef","useEffect","subscription","takeWhile","unsubscribe","offsetWidth","ref","className","style","position","anime","index","slice","display","alignItems","justifyContent","top","left","styleAnimeItem","color","size","margin","fontSize","RelatedAnime","isLoading","useState","animeDetailStream","recommendationState","setRecommendationState","buttonRef","dataRelatedAnime","pageRelated","onClick"],"mappings":"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","file":"static/js/34.9ad7003a.chunk.js","sourcesContent":["/* eslint-disable no-useless-escape */\r\nexport const mobileAndTabletCheck = () => {\r\n  let check = false;\r\n  (function (a) {\r\n    if (\r\n      /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(\r\n        a\r\n      ) ||\r\n      /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(\r\n        a.substr(0, 4)\r\n      )\r\n    )\r\n      check = true;\r\n  })(navigator.userAgent || navigator.vendor || window.opera);\r\n  return check;\r\n};\r\n","/* eslint-disable no-unused-vars */\r\nimport { BehaviorSubject } from \"rxjs\";\r\nconst initialState = {\r\n  genreDetailData: [],\r\n  pageOnDestroy: null,\r\n  pageIsLoaded:null,\r\n  isChangeView: false,\r\n  isStopScrollingUpdated: false,\r\n  currentPageOnDestroy: null,\r\n  query:null,\r\n  pageGenre: 1,\r\n  numberAnimeShowMore: (parseInt(window.innerHeight / 376) + 1) * 5,\r\n  width: null,\r\n  height: null,\r\n  quantityItemPerRow: 5,\r\n  widthItem: null,\r\n  heightItem: null,\r\n  rowStart: 0,\r\n  rowEnd: 0,\r\n  widthContainerList: \"100%\",\r\n  trigger:true,\r\n};\r\n\r\nconst subject = new BehaviorSubject(initialState);\r\nlet state = initialState;\r\nconst lazyLoadAnimeListStore = {\r\n  initialState,\r\n  subscribe: (setState) => subject.pipe().subscribe((v) => setState(v)),\r\n  currentState: () => {\r\n    let ans;\r\n    subject.subscribe((v) => (ans = v));\r\n    return ans || initialState;\r\n  },\r\n  init: () => {\r\n    subject.next(state);\r\n  },\r\n  updateData: (data = initialState) => {\r\n    state = {\r\n      ...state,\r\n      ...data,\r\n    };\r\n    subject.next(state);\r\n  },\r\n  updateDataQuick: (data = initialState) => {\r\n    const keys = Object.keys(data);\r\n    keys.forEach((key) => {\r\n      state[key] = data[key];\r\n    });\r\n  },\r\n};\r\n\r\nexport default lazyLoadAnimeListStore;\r\n","import { fromEvent, iif, of, timer } from \"rxjs\";\r\nimport { ajax } from \"rxjs/ajax\";\r\nimport {\r\n  catchError,\r\n  debounceTime,\r\n  filter,\r\n  mergeMap,\r\n  mergeMapTo,\r\n  pluck,\r\n  tap,\r\n  timeout,\r\n  map,\r\n} from \"rxjs/operators\";\r\nimport cachesStore from \"../store/caches\";\r\n\r\nimport lazyLoadAnimeListStore from \"../store/lazyLoadAnimeList\";\r\n\r\nexport const lazyLoadAnimeListStream = lazyLoadAnimeListStore;\r\n\r\nexport function fetchDataGenreAnimeList$(\r\n  page,\r\n  url,\r\n  idCartoonUser,\r\n  searchBy,\r\n  query\r\n) {\r\n  let obj = {\r\n    method: \"GET\",\r\n    url: url.replace(\"{page}\", page),\r\n  };\r\n  if ([\"latest\", \"box\"].includes(searchBy)) {\r\n    obj.headers = {\r\n      authorization: `Bearer ${idCartoonUser}`,\r\n    };\r\n  }\r\n  return iif(\r\n    () =>\r\n      cachesStore.currentState().genres &&\r\n      cachesStore.currentState().genres[url.replace(\"{page}\", page)],\r\n    timer(0).pipe(\r\n      map(() => cachesStore.currentState().genres[url.replace(\"{page}\", page)])\r\n    ),\r\n    timer(0).pipe(\r\n      filter(() => page === parseInt(page)),\r\n      tap(() => {\r\n        lazyLoadAnimeListStream.updateData({\r\n          pageIsLoaded: page,\r\n        });\r\n      }),\r\n      mergeMapTo(\r\n        iif(\r\n          () =>\r\n            cachesStore.currentState().genres &&\r\n            cachesStore.currentState().genres[query] &&\r\n            cachesStore.currentState().genres[query][page],\r\n          timer(0).pipe(\r\n            map(() => cachesStore.currentState().genres[query][page])\r\n          ),\r\n          timer(0).pipe(\r\n            mergeMap(() =>\r\n              ajax(obj).pipe(\r\n                timeout(5000),\r\n                pluck(\"response\"),\r\n                catchError(() => {\r\n                  return of({ error: true });\r\n                })\r\n              )\r\n            )\r\n          )\r\n        )\r\n      )\r\n    )\r\n  );\r\n}\r\n\r\nexport function updatePageScrollingWindow$() {\r\n  return fromEvent(window, \"scroll\").pipe(\r\n    filter(\r\n      () =>\r\n        document.body.scrollHeight - (window.scrollY + window.innerHeight) < 0\r\n    ),\r\n    debounceTime(300)\r\n  );\r\n}\r\n\r\nexport function calculateRowStartEnd(containerListRef, heightItem) {\r\n  const offsetTopContainerList = containerListRef.current.offsetTop;\r\n  const currentRow = Math.ceil(\r\n    (-offsetTopContainerList + window.scrollY + window.innerHeight) / heightItem\r\n  );\r\n  const numberRowToFillTheScreen =\r\n    Math.ceil(window.innerHeight / heightItem) +\r\n    lazyLoadAnimeListStream.currentState().quantityItemPerRow;\r\n  const rowStart =\r\n    currentRow - numberRowToFillTheScreen >= 1\r\n      ? currentRow - numberRowToFillTheScreen\r\n      : 1;\r\n  const rowEnd = currentRow + numberRowToFillTheScreen;\r\n  return { rowStart, rowEnd };\r\n}\r\n","import \"./AnimeList.css\";\r\n\r\nimport loadable from \"@loadable/component\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport React, { useEffect, useRef } from \"react\";\r\nimport { fromEvent, iif } from \"rxjs\";\r\n\r\nimport {\r\n  calculateRowStartEnd,\r\n  lazyLoadAnimeListStream,\r\n} from \"../../epics/lazyLoadAnimeList\";\r\nimport { debounceTime, takeWhile } from \"rxjs/operators\";\r\nimport { mobileAndTabletCheck } from \"../../util/checkMobileDevice\";\r\nconst responsiveObject = [\r\n  {\r\n    maxWidth: 100000,\r\n    minWidth: 1000,\r\n    quantityItemPerRow: 5,\r\n  },\r\n  {\r\n    maxWidth: 1000,\r\n    minWidth: 600,\r\n    quantityItemPerRow: 4,\r\n  },\r\n  {\r\n    maxWidth: 600,\r\n    minWidth: 500,\r\n    quantityItemPerRow: 3,\r\n  },\r\n  {\r\n    maxWidth: 500,\r\n    minWidth: 0,\r\n    quantityItemPerRow: 2,\r\n  },\r\n];\r\nconst AnimeItem = loadable(() => import(\"../AnimeItem/AnimeItem\"));\r\nconst AnimeList = ({\r\n  data,\r\n  error,\r\n  isWrap = true,\r\n  lazy = false,\r\n  empty = false,\r\n  virtual = false,\r\n  isAllowDelete = false,\r\n  searchBy,\r\n  type\r\n}) => {\r\n  const animeListRef = useRef();\r\n  const lazyLoadState = lazyLoadAnimeListStream.currentState();\r\n  useEffect(() => {\r\n    const subscription = iif(\r\n      () => mobileAndTabletCheck(),\r\n      fromEvent(window, \"scroll\").pipe(takeWhile(() => virtual)),\r\n      fromEvent(window, \"scroll\").pipe(\r\n        takeWhile(() => virtual),\r\n        debounceTime(50)\r\n      )\r\n    ).subscribe(() => {\r\n      const { rowStart, rowEnd } = calculateRowStartEnd(\r\n        animeListRef,\r\n        lazyLoadState.heightItem\r\n      );\r\n      if (\r\n        rowStart !== lazyLoadState.rowStart &&\r\n        rowEnd !== lazyLoadState.rowEnd\r\n      ) {\r\n        lazyLoadAnimeListStream.updateData({\r\n          rowStart,\r\n          rowEnd,\r\n        });\r\n      }\r\n    });\r\n    return () => {\r\n      subscription.unsubscribe();\r\n    };\r\n  }, [\r\n    lazyLoadState.heightItem,\r\n    lazyLoadState.rowEnd,\r\n    lazyLoadState.rowStart,\r\n    virtual,\r\n  ]);\r\n  useEffect(() => {\r\n    handleResponsiveWidth(animeListRef, lazyLoadState);\r\n    const subscription = fromEvent(window, \"resize\")\r\n      .pipe(debounceTime(500))\r\n      .subscribe(() => {\r\n        handleResponsiveWidth(animeListRef, lazyLoadState);\r\n      });\r\n    return () => {\r\n      subscription.unsubscribe();\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [lazyLoadState.heightItem, lazyLoadState.rowEnd, lazyLoadState.rowStart]);\r\n  useEffect(() => {\r\n    if (!virtual) return;\r\n    const widthItem =\r\n      animeListRef.current.offsetWidth / lazyLoadState.quantityItemPerRow;\r\n    const heightItem = (widthItem * 340) / 224;\r\n    const height =\r\n      Math.ceil(\r\n        lazyLoadState.genreDetailData.length / lazyLoadState.quantityItemPerRow\r\n      ) * heightItem;\r\n    const { rowStart, rowEnd } = calculateRowStartEnd(animeListRef, heightItem);\r\n    lazyLoadAnimeListStream.updateData({\r\n      width: animeListRef.current.offsetWidth,\r\n      height,\r\n      widthItem,\r\n      heightItem,\r\n      rowStart: rowStart,\r\n      rowEnd: rowEnd,\r\n    });\r\n  }, [\r\n    lazyLoadState.heightItem,\r\n    lazyLoadState.quantityItemPerRow,\r\n    lazyLoadState.genreDetailData.length,\r\n    lazyLoadState.trigger,\r\n    virtual,\r\n  ]);\r\n\r\n  return (\r\n    <div\r\n      ref={animeListRef}\r\n      className={isWrap ? \"list-anime\" : \"list-anime-nowrap\"}\r\n      style={{\r\n        position: virtual ? \"relative\" : \"static\",\r\n        height: lazyLoadState.height,\r\n        width: lazyLoadState.widthContainerList\r\n          ? lazyLoadState.widthContainerList\r\n          : 280,\r\n      }}\r\n    >\r\n      {data &&\r\n        !virtual &&\r\n        !error &&\r\n        data.map((anime, index) => {\r\n          return (\r\n            <AnimeItem\r\n              key={index}\r\n              anime={anime}\r\n              lazy={lazy}\r\n              searchBy={searchBy}\r\n              virtual={false}\r\n              isAllowDelete={isAllowDelete}\r\n              type={type}\r\n            />\r\n          );\r\n        })}\r\n      {data &&\r\n        virtual &&\r\n        !error &&\r\n        data\r\n          .slice(\r\n            (lazyLoadState.rowStart - 1) * lazyLoadState.quantityItemPerRow,\r\n            (lazyLoadState.rowEnd - 1) * lazyLoadState.quantityItemPerRow\r\n          )\r\n          .map((anime, index) => {\r\n            return (\r\n              <div\r\n                key={\r\n                  (lazyLoadState.rowStart - 1) *\r\n                    lazyLoadState.quantityItemPerRow +\r\n                  index\r\n                }\r\n                style={\r\n                  virtual\r\n                    ? {\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        justifyContent: \"center\",\r\n                        height: lazyLoadState.heightItem,\r\n                        width: lazyLoadState.widthItem,\r\n                        position: \"absolute\",\r\n                        top:\r\n                          parseInt(\r\n                            ((lazyLoadState.rowStart - 1) *\r\n                              lazyLoadState.quantityItemPerRow +\r\n                              index) /\r\n                              lazyLoadState.quantityItemPerRow\r\n                          ) * lazyLoadState.heightItem,\r\n                        left:\r\n                          parseInt(\r\n                            ((lazyLoadState.rowStart - 1) *\r\n                              lazyLoadState.quantityItemPerRow +\r\n                              index) %\r\n                              lazyLoadState.quantityItemPerRow\r\n                          ) * lazyLoadState.widthItem,\r\n                      }\r\n                    : {}\r\n                }\r\n              >\r\n                <AnimeItem\r\n                type={type}\r\n                  anime={anime}\r\n                  lazy={lazy}\r\n                  virtual={true}\r\n                  isAllowDelete={isAllowDelete}\r\n                  styleAnimeItem={{ width: \"90%\", height: \"95%\" }}\r\n                  searchBy={searchBy}\r\n                />\r\n              </div>\r\n            );\r\n          })}\r\n      {data && data.length === 0 && empty && (\r\n        <div className=\"empty\">\r\n          <CircularProgress color=\"secondary\" size=\"4rem\" />\r\n        </div>\r\n      )}\r\n      {error && (\r\n        <div\r\n          style={{\r\n            margin: \"100px auto 0 auto\",\r\n            color: \"white\",\r\n            fontSize: \"150%\",\r\n          }}\r\n        >\r\n          Anime is being updated...\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nfunction handleResponsiveWidth(animeListRef, lazyLoadState) {\r\n  const { rowStart, rowEnd } = calculateRowStartEnd(\r\n    animeListRef,\r\n    lazyLoadState.heightItem\r\n  );\r\n  for (let i = 0; i < responsiveObject.length; i++) {\r\n    const { maxWidth, minWidth, quantityItemPerRow } = responsiveObject[i];\r\n    if (window.innerWidth < maxWidth && window.innerWidth > minWidth) {\r\n      lazyLoadAnimeListStream.updateData({\r\n        quantityItemPerRow,\r\n      });\r\n      break;\r\n    }\r\n  }\r\n  if (rowStart !== lazyLoadState.rowStart && rowEnd !== lazyLoadState.rowEnd) {\r\n    lazyLoadAnimeListStream.updateData({\r\n      rowStart,\r\n      rowEnd,\r\n    });\r\n  }\r\n  lazyLoadAnimeListStream.updateData({\r\n    trigger: !lazyLoadAnimeListStream.currentState().trigger,\r\n  });\r\n}\r\n\r\nexport default AnimeList;\r\n","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport \"./RelatedAnime.css\";\r\nimport \"react-lazy-load-image-component/src/effects/opacity.css\";\r\n\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\n\r\nimport { animeDetailStream } from \"../../epics/animeDetail\";\r\nimport AnimeList from \"../AnimeList/AnimeList\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\n\r\nconst RelatedAnime = ({ isLoading, type }) => {\r\n  const [recommendationState, setRecommendationState] = useState(\r\n    animeDetailStream.currentState() \r\n  );\r\n  const buttonRef = useRef();\r\n  useEffect(() => {\r\n    const subscription = animeDetailStream.subscribe(setRecommendationState);\r\n    return () => {\r\n      subscription.unsubscribe();\r\n    };\r\n  }, []);\r\n  useEffect(() => {\r\n    if (buttonRef.current) {\r\n      if (\r\n        recommendationState.dataRelatedAnime.length >\r\n        10 * recommendationState.pageRelated\r\n      ) {\r\n        buttonRef.current.style.display = \"block\";\r\n      } else {\r\n        buttonRef.current.style.display = \"none\";\r\n      }\r\n    }\r\n  }, [\r\n    recommendationState.pageRelated,\r\n    recommendationState.dataRelatedAnime.length,\r\n  ]);\r\n  return (\r\n    recommendationState.dataRelatedAnime.length > 0 && (\r\n      <div className=\"recommendation-anime-container\">\r\n        <h1 className=\"title\">You might like...</h1>\r\n        {isLoading === true && (\r\n          <CircularProgress color=\"secondary\" size=\"4rem\" />\r\n        )}\r\n        {isLoading === false && (\r\n          <div>\r\n            <AnimeList\r\n              data={recommendationState.dataRelatedAnime.slice(\r\n                0,\r\n                10 * recommendationState.pageRelated\r\n              )}\r\n              error={null}\r\n              lazy={true}\r\n              searchBy={\"anime\"}\r\n              type={type}\r\n            />\r\n            <div\r\n              className=\"see-more-movie\"\r\n              ref={buttonRef}\r\n              onClick={() => {\r\n                animeDetailStream.updateData({\r\n                  pageRelated: animeDetailStream.currentState().pageRelated + 1,\r\n                });\r\n              }}\r\n            >\r\n              See more\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    )\r\n  );\r\n};\r\n\r\nexport default RelatedAnime;\r\n"],"sourceRoot":""}